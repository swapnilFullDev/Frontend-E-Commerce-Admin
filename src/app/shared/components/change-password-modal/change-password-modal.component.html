<div class="p-6">
    <div class="flex items-center justify-between mb-4">
        <h2 class="text-xl font-semibold text-gray-800">Change Password</h2>
        <button mat-icon-button (click)="close()" class="square-icon-btn">
            <mat-icon>close</mat-icon>
        </button>
    </div>

    <form [formGroup]="changePasswordForm" class="space-y-4">
        <mat-form-field class="w-full">
            <mat-label>Current Password</mat-label>
            <input matInput [type]="hideCurrentPassword ? 'password' : 'text'" formControlName="currentPassword">
            <button matSuffix mat-icon-button (click)="hideCurrentPassword = !hideCurrentPassword" type="button">
                <mat-icon>{{hideCurrentPassword ? 'visibility_off' : 'visibility'}}</mat-icon>
            </button>
            @if(changePasswordForm.get('currentPassword')?.hasError('required')){
            <mat-error>Current password is required</mat-error>
            }
        </mat-form-field>

        <mat-form-field class="w-full">
            <mat-label>New Password</mat-label>
            <input matInput [type]="hideNewPassword ? 'password' : 'text'" formControlName="newPassword">
            <button matSuffix mat-icon-button (click)="hideNewPassword = !hideNewPassword" type="button">
                <mat-icon>{{hideNewPassword ? 'visibility_off' : 'visibility'}}</mat-icon>
            </button>
            @if(changePasswordForm.get('newPassword')?.hasError('required')){
            <mat-error>New password is required</mat-error>
            }
            @if(changePasswordForm.get('newPassword')?.hasError('minlength')){
            <mat-error>Password must be at least 6 characters</mat-error>
            }
        </mat-form-field>

        <mat-form-field class="w-full">
            <mat-label>Confirm New Password</mat-label>
            <input matInput [type]="hideConfirmPassword ? 'password' : 'text'" formControlName="confirmPassword">
            <button matSuffix mat-icon-button (click)="hideConfirmPassword = !hideConfirmPassword" type="button">
                <mat-icon>{{hideConfirmPassword ? 'visibility_off' : 'visibility'}}</mat-icon>
            </button>
            @if(changePasswordForm.get('confirmPassword')?.hasError('required')){
            <mat-error>Confirm password is required</mat-error>
            }
            @if(changePasswordForm.hasError('passwordMismatch') && changePasswordForm.get('confirmPassword')?.touched){
            <mat-error>Passwords do not match</mat-error>
            }
        </mat-form-field>
    </form>

    <div class="flex justify-end gap-3 mt-6">
        <button mat-button (click)="close()" class="text-gray-600">Cancel</button>
        <button mat-raised-button color="primary" (click)="onSubmit()"
            [disabled]="changePasswordForm.invalid || isLoading">
            {{ isLoading ? 'Changing...' : 'Change Password' }}
        </button>
    </div>
</div>